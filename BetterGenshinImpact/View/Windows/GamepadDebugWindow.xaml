<Window x:Class="BetterGenshinImpact.View.Windows.GamepadDebugWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:viewModel="clr-namespace:BetterGenshinImpact.ViewModel.Windows"
        Title="手柄调试窗口"
        Width="600"
        Height="700"
        FontFamily="{DynamicResource TextThemeFontFamily}"
        WindowStartupLocation="CenterScreen"
        mc:Ignorable="d">
    <Window.DataContext>
        <viewModel:GamepadDebugViewModel />
    </Window.DataContext>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
        <!-- 标题 -->
        <TextBlock Grid.Row="0"
                   Text="手柄调试界面"
                   FontSize="24"
                   FontWeight="Bold"
                   Margin="0,0,0,20" />
        
        <!-- 当前输入模式 -->
        <Border Grid.Row="1"
                Background="{DynamicResource CardBackground}"
                BorderBrush="{DynamicResource CardBorderBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="当前输入模式"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Margin="0,0,0,10" />
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBlock Text="模式: "
                               FontSize="14"
                               VerticalAlignment="Center" />
                    <TextBlock Text="{Binding CurrentMode}"
                               FontSize="14"
                               FontWeight="Bold"
                               Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}"
                               VerticalAlignment="Center" />
                </StackPanel>
                
                <!-- 模式切换按钮 -->
                <StackPanel Orientation="Horizontal">
                    <ui:Button Content="切换到键盘鼠标"
                               Command="{Binding SwitchToKeyboardMouseCommand}"
                               Margin="0,0,10,0"
                               Padding="12,6"
                               FontSize="13" />
                    <ui:Button Content="切换到 XInput 手柄"
                               Command="{Binding SwitchToXInputCommand}"
                               Padding="12,6"
                               FontSize="13" />
                </StackPanel>
            </StackPanel>
        </Border>
        
        <!-- 按钮状态 -->
        <Border Grid.Row="2"
                Background="{DynamicResource CardBackground}"
                BorderBrush="{DynamicResource CardBorderBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="手柄按钮状态"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Margin="0,0,0,10" />
                <ItemsControl ItemsSource="{Binding ButtonStates}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Margin="5"
                                    Padding="8,4"
                                    CornerRadius="4"
                                    BorderThickness="1">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#33808080" />
                                        <Setter Property="BorderBrush" Value="#66808080" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsPressed}" Value="True">
                                                <Setter Property="Background" Value="#6600FF00" />
                                                <Setter Property="BorderBrush" Value="#FF00FF00" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock Text="{Binding ButtonName}"
                                           FontSize="12" />
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Border>
        
        <!-- 摇杆坐标 -->
        <Border Grid.Row="3"
                Background="{DynamicResource CardBackground}"
                BorderBrush="{DynamicResource CardBorderBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="摇杆坐标值"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Margin="0,0,0,10" />
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    
                    <!-- 左摇杆 -->
                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <TextBlock Text="左摇杆 (移动)"
                                   FontSize="14"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,5" />
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="X: " Width="30" />
                            <TextBlock Text="{Binding LeftStickX}"
                                       FontFamily="Consolas"
                                       FontWeight="Bold"
                                       Width="60" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Y: " Width="30" />
                            <TextBlock Text="{Binding LeftStickY}"
                                       FontFamily="Consolas"
                                       FontWeight="Bold"
                                       Width="60" />
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- 右摇杆 -->
                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                        <TextBlock Text="右摇杆 (镜头)"
                                   FontSize="14"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,5" />
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="X: " Width="30" />
                            <TextBlock Text="{Binding RightStickX}"
                                       FontFamily="Consolas"
                                       FontWeight="Bold"
                                       Width="60" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Y: " Width="30" />
                            <TextBlock Text="{Binding RightStickY}"
                                       FontFamily="Consolas"
                                       FontWeight="Bold"
                                       Width="60" />
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>
        
        <!-- 扳机压力值 -->
        <Border Grid.Row="4"
                Background="{DynamicResource CardBackground}"
                BorderBrush="{DynamicResource CardBorderBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="扳机压力值"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Margin="0,0,0,10" />
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    
                    <!-- 左扳机 -->
                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="左扳机 (LT): " Width="90" />
                            <TextBlock Text="{Binding LeftTrigger}"
                                       FontFamily="Consolas"
                                       FontWeight="Bold"
                                       Width="40" />
                        </StackPanel>
                        <ProgressBar Value="{Binding LeftTrigger}"
                                     Maximum="255"
                                     Height="20" />
                    </StackPanel>
                    
                    <!-- 右扳机 -->
                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="右扳机 (RT): " Width="90" />
                            <TextBlock Text="{Binding RightTrigger}"
                                       FontFamily="Consolas"
                                       FontWeight="Bold"
                                       Width="40" />
                        </StackPanel>
                        <ProgressBar Value="{Binding RightTrigger}"
                                     Maximum="255"
                                     Height="20" />
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>
        
        <!-- 手动测试按钮 -->
        <Border Grid.Row="5"
                Background="{DynamicResource CardBackground}"
                BorderBrush="{DynamicResource CardBorderBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="15">
            <StackPanel>
                <TextBlock Text="手动测试"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Margin="0,0,0,10" />
                
                <WrapPanel Orientation="Horizontal">
                    <ui:Button Content="测试 A 按钮"
                               Command="{Binding TestButtonACommand}"
                               Margin="0,0,10,10"
                               Padding="15,8" />
                    <ui:Button Content="测试 B 按钮"
                               Command="{Binding TestButtonBCommand}"
                               Margin="0,0,10,10"
                               Padding="15,8" />
                    <ui:Button Content="测试 X 按钮"
                               Command="{Binding TestButtonXCommand}"
                               Margin="0,0,10,10"
                               Padding="15,8" />
                    <ui:Button Content="测试 Y 按钮"
                               Command="{Binding TestButtonYCommand}"
                               Margin="0,0,10,10"
                               Padding="15,8" />
                </WrapPanel>
                
                <WrapPanel Orientation="Horizontal" Margin="0,5,0,0">
                    <ui:Button Content="测试左摇杆"
                               Command="{Binding TestLeftStickCommand}"
                               Margin="0,0,10,10"
                               Padding="15,8" />
                    <ui:Button Content="测试右摇杆"
                               Command="{Binding TestRightStickCommand}"
                               Margin="0,0,10,10"
                               Padding="15,8" />
                    <ui:Button Content="测试扳机"
                               Command="{Binding TestTriggersCommand}"
                               Margin="0,0,10,10"
                               Padding="15,8" />
                </WrapPanel>
                
                <ui:Button Content="重置所有状态"
                           Command="{Binding ResetAllCommand}"
                           Margin="0,10,0,0"
                           Padding="15,8"
                           HorizontalAlignment="Left" />
            </StackPanel>
        </Border>
    </Grid>
</Window>
